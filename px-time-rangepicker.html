<link rel="import" href="../polymer/polymer.html"/>
<link rel="import" href="px-time-input.html"/>

<script src="../moment/moment.js"></script>

<!--
Timepicker element which allows user to select a start and end time.

##### Usage

    <px-timepicker from-time="{{fromTime}}" to-time="{{toTime}}"></px-timepicker>

-->
<dom-module id="px-time-rangepicker">
  <link rel="import" type="css" href="css/px-time-rangepicker.css"/>
  <template>
    <div class=rangepicker__box>
      <div class="flex flex--middle border--bottom u-pr+">
        <px-time-input id="fromTimeInput" class="u-pv+ u-pl+" time="{{fromTimeInput}}"></px-time-input>
        <span class=u-mh->-</span>
        <px-time-input id="toTimeInput" class="u-pv+ u-pr+ border--right" time="{{toTimeInput}}"></px-time-input>
        <div class=rangepicker__box__select>
          <label class="caps weight--semibold u-mb-">Time Range</label>
          <select>
            <option>Select</option>
            <option>1 minute</option>
            <option>5 minutes</option>
            <option>10 minutes</option>
          </select>
        </div>
      </div>
      <div class="flex flex--right u-p-">
        <input class="btn btn--primary" type=submit value=Apply on-click="_applyTime">
        <button class=btn on-click="_cancel">Cancel</button>
      </div>
    </div>
  </template>
</dom-module>

<script>
  Polymer({

    is: 'px-time-rangepicker',

    properties: {

      /**
       * Moment object with start time for time picker
       */
      toTime: {
        type: Object,
        notify: true,
        observer: '_changeToTime'
      },

      /**
       * Moment object with start time for time picker
       */
      fromTime: {
        type: Object,
        notify: true,
        observer: '_changeFromTime'
      }

    },

    _changeToTime: function() {
      this.set('toTimeInput', moment(this.toTime));
    },

    _changeFromTime: function() {
      this.set('fromTimeInput', moment(this.fromTime));
    },

    _applyTime: function() {
      this.set('toTime', moment(this.toTimeInput)); // set the selected time to the input time
      this.set('fromTime', moment(this.fromTimeInput));
      this.fire('px-time-picking-done');
    },

    _cancel: function() {
      this.set('toTimeInput', moment(this.toTime)); // reset the input to the previously chosen time
      this.set('fromTimeInput', moment(this.fromTime));
      this.fire('px-time-picking-done');
    }

  });
</script>
